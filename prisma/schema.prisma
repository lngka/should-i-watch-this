generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Job {
  id           String    @id @default(cuid())
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  status       JobStatus @default(PENDING)
  videoUrl     String
  errorMessage String?
  analysis     Analysis?
}

model Analysis {
  id           String   @id @default(cuid())
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  videoId      String?
  jobId        String?  @unique
  oneLiner     String
  bulletPoints Json
  outline      Json
  trustScore   Int
  trustSignals Json
  language     String?
  languageCode String?
  job          Job?     @relation(fields: [jobId], references: [id])
  video        Video?   @relation(fields: [videoId], references: [id])
  claims       Claim[]
}

model Video {
  id           String     @id @default(cuid())
  url          String     @unique
  title        String?
  channel      String?
  transcript   String?
  transcriptId String?
  analyses     Analysis[]
}

model Claim {
  id         String      @id @default(cuid())
  analysisId String
  text       String
  confidence Int
  analysis   Analysis    @relation(fields: [analysisId], references: [id])
  spotChecks SpotCheck[]
}

model SpotCheck {
  id      String @id @default(cuid())
  claimId String
  url     String
  summary String
  verdict String
  claim   Claim  @relation(fields: [claimId], references: [id])
}

enum JobStatus {
  PENDING
  RUNNING
  COMPLETED
  FAILED
}
